# 板式家具加工工艺流程设计系统 - 功能说明

## 🎯 系统概述

本系统是一个智能化的板式家具加工工艺流程设计和管理平台，支持工序预建立、可编辑计算逻辑、多部件产品组合等高级功能。

## 🏗️ 核心功能架构

### 1. 工序预建立系统

#### 工序模板管理
- **预定义工序**：系统预设了8种常用工序模板
  - 切割 (CUT) - 基础切割操作
  - 钻孔 (DRILL) - 钻孔加工
  - 封边 (EDGE) - 板材封边
  - 开槽 (GROOVE) - 开槽加工
  - 打磨 (SAND) - 表面打磨
  - 组装 (ASSEMBLE) - 部件组装
  - 喷漆 (PAINT) - 表面喷漆
  - 质检 (INSPECT) - 质量检查

#### 工序分类体系
- **切割类**：切割、开槽
- **钻孔类**：钻孔、打孔
- **封边类**：封边处理
- **打磨类**：表面打磨
- **组装类**：部件组装
- **表面处理类**：喷漆、贴面
- **质检类**：质量检查

#### 工序属性配置
- **工序代码**：唯一标识符
- **工序名称**：中文描述
- **工序分类**：按功能分类
- **计算逻辑**：关联的计算公式
- **所需设备**：执行工序的设备
- **所需材料**：工序消耗的材料
- **启用状态**：是否可用

### 2. 可编辑计算逻辑系统

#### 计算逻辑管理
- **公式编辑器**：支持数学表达式编辑
- **变量系统**：预定义12种计算变量
- **语法验证**：实时验证公式语法
- **逻辑复用**：多个工序可共用同一逻辑

#### 预定义计算变量
```typescript
// 基础尺寸变量
length: 部件长度 (mm)
width: 部件宽度 (mm)
thickness: 部件厚度 (mm)
area: 部件面积 (mm²)
volume: 部件体积 (mm³)

// 复杂度变量
complexity: 复杂度系数 (1.0-1.8)

// 特征变量
holeCount: 开孔数量 (个)
grooveCount: 开槽数量 (个)
chamferCount: 倒角数量 (个)
roundingCount: 圆角数量 (个)

// 影响系数
featureFactor: 特征影响系数
quantity: 部件数量 (个)
```

#### 预设计算公式
1. **基础切割公式**
   ```
   5 + (area / 10000) * 0.5 * complexity * featureFactor
   ```

2. **钻孔公式**
   ```
   2 + holeCount * 0.5 * complexity
   ```

3. **封边公式**
   ```
   3 + (length + width) * 2 / 1000 * complexity
   ```

4. **开槽公式**
   ```
   4 + grooveCount * 1.5 * complexity
   ```

5. **打磨公式**
   ```
   4 + (area / 10000) * 0.4 * complexity
   ```

6. **组装公式**
   ```
   8 + (length + width) / 1000 * 0.5 * complexity
   ```

7. **喷漆公式**
   ```
   15 + (area / 10000) * 0.8 * complexity
   ```

### 3. 多部件产品组合系统

#### 部件特征管理
- **基础尺寸**：长度、宽度、厚度
- **材料选择**：板材、五金、胶水等
- **复杂度分级**：简单、中等、复杂
- **特征定义**：开孔、开槽、倒角、圆角
- **数量设置**：部件生产数量

#### 部件特征类型
1. **开孔 (hole)**
   - 连接孔、拉手孔、通风孔
   - 影响系数：每个孔增加10%时间

2. **开槽 (groove)**
   - 滑轨槽、连接槽、装饰槽
   - 影响系数：每个槽增加20%时间

3. **倒角 (chamfer)**
   - 边缘倒角、安全倒角
   - 影响系数：每个倒角增加15%时间

4. **圆角 (rounding)**
   - 边缘圆角、装饰圆角
   - 影响系数：每个圆角增加25%时间

#### 产品组合管理
- **多部件组合**：一个产品包含多个部件
- **组装顺序**：定义部件组装顺序
- **组装工艺**：专门的组装工序
- **位置关系**：部件在产品中的位置
- **数量关系**：各部件的数量关系

## 📊 智能计算系统

### 1. 表达式解析器

#### 核心功能
- **数学运算**：支持 +、-、*、/、^ 运算
- **变量替换**：自动替换变量为数值
- **语法验证**：检查公式语法正确性
- **错误处理**：友好的错误提示

#### 计算流程
1. **变量准备**：根据部件信息准备变量值
2. **公式解析**：将中缀表达式转换为后缀表达式
3. **数值计算**：按运算符优先级计算结果
4. **结果验证**：确保计算结果合理

### 2. 时间计算算法

#### 基础计算
```typescript
// 单个工艺时间计算
calculatedTime = parseFormula(formula, variables)

// 部件总时间
componentTotalTime = sum(processTimes)

// 产品总时间
productTotalTime = sum(componentTotalTime * quantity)
```

#### 影响因素
- **尺寸影响**：面积越大，时间越长
- **复杂度影响**：复杂度越高，时间系数越大
- **特征影响**：开孔、开槽等特征增加时间
- **数量影响**：批量生产的时间累加

### 3. 成本计算系统

#### 材料成本
```typescript
// 按面积计算
materialCost = area(m²) * unitPrice * quantity

// 按件计算
materialCost = unitPrice * quantity

// 按重量计算
materialCost = volume(m³) * density * unitPrice * quantity
```

#### 人工成本
```typescript
laborCost = totalTime(hours) * hourlyRate
```

#### 管理成本
```typescript
overheadCost = (materialCost + laborCost) * overheadRate(20%)
```

## 🎨 用户界面设计

### 1. 多标签页管理
- **概览**：系统整体统计和流程图
- **产品设计**：部件和工艺配置
- **工序模板**：工序和计算逻辑管理
- **产品组合**：多部件产品组装
- **效率配置**：传统效率参数管理
- **材料管理**：材料信息管理
- **设备管理**：设备信息管理

### 2. 可视化展示
- **工艺流程图**：ReactFlow实现的交互式流程图
- **统计面板**：实时数据统计展示
- **成本分析**：多维度成本分析图表
- **特征统计**：部件特征统计信息

### 3. 交互体验
- **拖拽操作**：流程图节点拖拽
- **实时计算**：参数变化即时更新
- **表单验证**：输入数据实时验证
- **状态反馈**：操作结果即时反馈

## 🔧 技术实现

### 1. 前端技术栈
- **React 19**：最新版本，性能优异
- **TypeScript**：类型安全，开发体验佳
- **Ant Design 5**：企业级UI组件库
- **ReactFlow**：专业流程图组件
- **Vite**：快速构建工具

### 2. 数据管理
- **状态管理**：React Hooks状态管理
- **类型定义**：完整的TypeScript类型系统
- **数据验证**：运行时数据验证
- **错误处理**：完善的错误处理机制

### 3. 计算引擎
- **表达式解析**：自定义数学表达式解析器
- **变量系统**：灵活的变量定义和管理
- **公式验证**：实时公式语法验证
- **性能优化**：高效的计算算法

## 📈 扩展功能

### 1. 已实现功能
- ✅ 工序模板预建立
- ✅ 可编辑计算逻辑
- ✅ 多部件产品组合
- ✅ 智能时间计算
- ✅ 成本自动分析
- ✅ 可视化流程图
- ✅ 特征统计分析

### 2. 计划功能
- 🔄 材料库存管理
- 🔄 设备状态监控
- 🔄 生产进度跟踪
- 🔄 数据导出功能
- 🔄 用户权限管理
- 🔄 历史记录管理
- 🔄 报表生成功能
- 🔄 成本优化建议

## 🎯 使用场景

### 1. 产品设计阶段
- 定义产品结构和部件
- 配置部件特征和工艺
- 计算预估时间和成本
- 优化设计方案

### 2. 工艺规划阶段
- 建立工序模板库
- 配置计算逻辑
- 标准化工艺流程
- 提高计算精度

### 3. 生产管理阶段
- 跟踪生产进度
- 监控成本变化
- 优化生产效率
- 质量控制管理

## 🚀 系统优势

### 1. 智能化
- **自动计算**：基于公式的智能时间计算
- **实时更新**：参数变化即时反映结果
- **智能验证**：自动验证数据合理性

### 2. 标准化
- **工序模板**：标准化工序定义
- **计算逻辑**：标准化计算公式
- **数据格式**：标准化数据结构

### 3. 可视化
- **流程图**：直观的工艺流程图
- **统计图表**：清晰的数据展示
- **交互操作**：友好的用户界面

### 4. 可扩展
- **模块化设计**：易于扩展新功能
- **配置化**：支持自定义配置
- **开放接口**：支持外部系统集成

---

**系统为板式家具制造提供了完整的数字化解决方案，大大提高了设计效率和成本控制精度。** 🎉